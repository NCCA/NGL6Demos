#ifndef GAME_H__
#define GAME_H__

#include <ngl/Camera.h>
#include <ngl/TransformStack.h>
#include <ngl/Light.h>
#include <SDL.h>
#include <ngl/Obj.h>
#include <list>
#include "Rocket.h"
#include "StarMap.h"

class Game
{
  public :
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief ctor this will have a valid OpenGL context so we can create gl stuff
    //----------------------------------------------------------------------------------------------------------------------
    Game();
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief dtor used to remove any NGL stuff created
    //----------------------------------------------------------------------------------------------------------------------
    ~Game();
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief resize our screen and set the camera aspect ratio
    /// @param[in] _w the new width
    /// @param[in] _h the new height
    //----------------------------------------------------------------------------------------------------------------------
    void resize(int _w, int _h);
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief draw the scene
    //----------------------------------------------------------------------------------------------------------------------
    void draw();
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief move the ship by offset _dx/y/z
    /// @param [in] _dx the cange in x
    /// @param [in] _dy the cange in y
    /// @param [in] _dz the cange in z
    //----------------------------------------------------------------------------------------------------------------------
    inline void move(float _dx, float _dy, float _dz)
    {
      m_modelPos.m_x+=_dx;
      m_modelPos.m_y+=_dy;
      m_modelPos.m_z+=_dz;
    }

    //----------------------------------------------------------------------------------------------------------------------
    /// @brief reset the ship to the origin
    //----------------------------------------------------------------------------------------------------------------------
    inline void resetPosition(){m_modelPos.set(0,0,0); }
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief fire rockets from the left
    /// @param[in] _speed the velocity of the rocket
    //----------------------------------------------------------------------------------------------------------------------
    void fireLeft(float _speed);
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief fire rockets from the right
    /// @param[in] _speed the velocity of the rocket
    //----------------------------------------------------------------------------------------------------------------------
    void fireRight(float _speed);
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief this updates the rocket list and removes any dead ones
    //----------------------------------------------------------------------------------------------------------------------
    void update();


  private :
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief method to load transform data to the shaders
    //----------------------------------------------------------------------------------------------------------------------
    void loadMatricesToShader();
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief Our Camera
    //----------------------------------------------------------------------------------------------------------------------
    ngl::Camera *m_cam;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief transformation stack for the gl transformations etc
    //----------------------------------------------------------------------------------------------------------------------
    ngl::TransformStack m_transformStack;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief the model position for mouse movement
    //----------------------------------------------------------------------------------------------------------------------
    ngl::Vec3 m_modelPos;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief the spaceship model
    //----------------------------------------------------------------------------------------------------------------------
    ngl::Obj *m_shipMesh;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief the rocket model
    //----------------------------------------------------------------------------------------------------------------------
    ngl::Obj *m_rocket;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief max rockets to be fired
    //----------------------------------------------------------------------------------------------------------------------
    int m_maxRockets;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief max rockets to be fired
    //----------------------------------------------------------------------------------------------------------------------
    int m_activeRockets;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief our rocket list we use a list so we can use some algorithms
    //----------------------------------------------------------------------------------------------------------------------
    std::list <Rocket *> m_rockets;
    //----------------------------------------------------------------------------------------------------------------------
    /// @brief starmap
    //----------------------------------------------------------------------------------------------------------------------
    StarMap *m_starmap;


};


#endif
